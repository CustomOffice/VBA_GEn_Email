{"name":"Vba gen email","tagline":"Macro pour générer un email avec outlook en 3 partie, un texte (intro), un tableau et un texte (signature)","body":"# VBA_Gen_Email\r\nMacro pour générer un email avec outlook en 3 partie, un texte (intro), un tableau et un texte (signature)\r\n\r\n## Instruction\r\n- Soit créer un module dans votre projet vba et y copier/coller le code ci-dessous\r\n- Soit télécharger le module (fichier *.bas) et l'inserer dans votre projet vba\r\n\r\n##Code\r\n```bash\r\n'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n'!!!TITRE : Génération d'email avec Outlook                                                         !!!\r\n'!!!DATE : 17.04.2015                                                                               !!!\r\n'!!!                                                                                                !!!\r\n'!!!DESCRIPTION : Macro pour générer un email avec outlook en 3 partie, un texte, un tableau et un \t!!!\r\n'!!!texte\t\t\t\t\t\t\t\t\t\t\t\t\t                                    \t!!!\r\n'!!!                                                                                                !!!\r\n'!!!REGLES :                                                                                        !!!\r\n'!!!- intro, tableau et signature sont des tableaux de valeurs, avec une valeur par retour à ligne  !!!\r\n'!!!- tableau représente le tableau présent dans le mail, ils feront les mêmes dimensions           !!!\r\n'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n\r\nSub gen_email_tabl(destinataire As String, objet As String, ByRef intro, ByRef tableau, ByRef signature, titre_tableau As Boolean)\r\n    'Déclaration des variables\r\n        'les objets\r\n    Dim objOL As Object, olmail As Object\r\n        'les constantes\r\n    Const olmailItem = 0 ' Outlook VBA constant olMailItem\r\n        'les string\r\n    Dim content_mail As String, style_bordure_tableau As String, police As String, couleur_police As String\r\n    Dim couleur_bordure As String, style_mail As String\r\n        'les integer\r\n    Dim t As Integer, l As Integer, i As Integer, taille_police As Integer, epaisseur_bordure As Integer, marge_interieur_cellule As Integer\r\n    \r\n    'Paramètre de personnalisation du mail\r\n    police = \"Arial\" ' n'utilisez que des polices \"standard\"\r\n    taille_police = 14 'en px\r\n    couleur_police = \"RGB(31,73,125)\" 'couleur en RGB, entre le blanc 255,255,255 et le noir 0,0,0\r\n    epaisseur_bordure = 1 'en px\r\n    couleur_bordure = \"RGB(31,73,125)\" 'couleur en RGB, entre le blanc 255,255,255 et le noir 0,0,0\r\n    marge_interieur_cellule = 5 'en px\r\n    \r\n    'création des styles\r\n    style_bordure_tableau = \"style='font-family:\" & police & \";font-size:\" & taille_police & \"px;border:\" & epaisseur_bordure & \"px solid \" & couleur_bordure & \";padding:\" & marge_interieur_cellule & \"px; color:\" & couleur_police & \"'\"\r\n    style_mail = \"style='font-family:\" & police & \";font-size:\" & taille_police & \"px;color:\" & couleur_police & \"'\"\r\n    \r\n    'init du contenu html du mail\r\n    content_mail = \"<body \" & style_mail & \">\"\r\n    content_mail = content_mail & \"<p>\"\r\n    \r\n    'ajout du texte d'intro du mail\r\n    For i = 0 To UBound(intro)\r\n        content_mail = content_mail & intro(i) & \"<br/>\"\r\n    Next i\r\n    \r\n    'init du tableau\r\n    content_mail = content_mail & \"<table style='border-collapse:collapse'>\"\r\n    \r\n    'ajout des titres du tableau si existant dans la variable\r\n    If titre_tableau = True Then\r\n        content_mail = content_mail & \"<tr>\"\r\n        For i = 0 To UBound(tableau, 2)\r\n            content_mail = content_mail & \"<th \" & style_bordure_tableau & \">\" & tableau(0, i) & \"</th>\"\r\n        Next i\r\n        content_mail = content_mail & \"</tr>\"\r\n        t = 1 'permet de savoir à quelle ligne du tableau commencer, 1 s'il y a des titres sinon 0\r\n    Else\r\n        t = 0\r\n    End If\r\n    \r\n    'ajout du reste du tableau\r\n    For l = t To UBound(tableau, 1)\r\n        content_mail = content_mail & \"<tr>\"\r\n        For i = 0 To UBound(tableau, 2)\r\n            content_mail = content_mail & \"<td \" & style_bordure_tableau & \">\" & tableau(l, i) & \"</td>\"\r\n        Next i\r\n        content_mail = content_mail & \"</tr>\"\r\n    Next l\r\n    \r\n    'fermeture du tableau\r\n    content_mail = content_mail & \"</table>\"\r\n    \r\n    'ajout de la signature\r\n    For i = 0 To UBound(signature)\r\n        content_mail = content_mail & signature(i) & \"<br/>\"\r\n    Next i\r\n    \r\n    'fermeture du contenu du mail\r\n    content_mail = content_mail & \"</p></body>\"\r\n        \r\n    'création du mail\r\n    Set objOL = CreateObject(\"Outlook.Application\")\r\n    Set olmail = objOL.CreateItem(olmailItem)\r\n    With olmail\r\n        .To = destinataire\r\n        .Subject = objet\r\n        .HTMLBody = content_mail\r\n        .Display\r\n    End With\r\n\r\nEnd Sub\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}